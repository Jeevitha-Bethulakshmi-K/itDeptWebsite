<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="./CSS/navigator.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
  <header>
    <img src="./Images/annaUniv.svg" alt="">
    <div class="heading">
    <div class="heading-title">Department of Information Technology</div>
    <div class="heading-dept">Anna University , MIT Campus</div>
    </div>
    <input type="checkbox" style="display:none"  id="nav-toggle" class="nav-toggle"> 
    <nav>
        <a href="./index.html">
          <i class="bi bi-house-door-fill"></i>
          Home
        </a>        
        <a href="#">
          <i class="bi bi-person-rolodex"></i>
          HOD's Desk</a>
        <a href="#">
          <i class="bi bi-images"></i>
          Gallery
        </a>
        <a href="./faculty.php">
          <i class="bi bi-people-fill"></i>
          Faculty</a>
        <a href="#">
          <i class="bi bi-mortarboard-fill"></i>
          Students</a>
        <a href="./curriculum.html">
          <i class="bi bi-book-half"></i>
          Curriculum</a>
        <a href="./infrastructure.html">
          <i class="bi bi-building"></i>
          Infrastructure</a>
        <a href="#">
          <i class="bi bi-motherboard-fill"></i>
          Research</a>
        <a href="#">
          <i class="bi bi-puzzle"></i>
          Events</a>
          
    </nav>
    <label for="nav-toggle">
      <span></span><i class="bi bi-x-lg"></i>
    </label>
  </header>
  <div class="body-start intro-v2 students-bg">
    <div class="intro-v2-content">
      <h1>Students</h1>
      <p>The computational needs of the researchers and engineers are met through well equipped laboratories. The resources in the department are continually updated with the changing industrial trends. The Advanced computing facility has been provided with the latest dual-core processors from Intel.</p>
    </div>
  </div>
    <div class="students-input">
      <input type="radio" name="degree" style="display:none;" id="ug" checked>
      <input type="radio" name="degree" style="display:none;" id="pg">
      <label class="students-input-element" for="ug">Under Graduate</label>
      <label class="students-input-element" for="pg">Post Graduate</label>
      <h2 style="color: #ab3c35;padding-inline: 1em;">Year :</h2>
      <select class="students-input-element" name="year" id="year">
      </select>
    </div>
  <div class="display-container" id="students-display">
    <span class="students-item">
      <span>S.No</span>
      <i>Register Number</i>
      <p>Student Name</p>
    </span>
    <span class="students-item">
      <span>1</span>
      <i></i>
      <p></p>
    </span>
  </div>
</body>
<script>
  const currentYr=2019;
  const years={
    ug:[2019,2018,2017,2016],
    pg:[2019,2018]
  }
  var year=currentYr;
  var deg='UG';
  function createStudent(sno,regNo,name){
    let item=document.createElement('div');
    item.className=" students-item";
    let s=document.createElement('span');
    s.innerText=sno;
    let r=document.createElement('i');
    r.innerText=regNo;
    let n=document.createElement('p');
    n.innerText=name;
    item.appendChild(s);
    item.appendChild(r);
    item.appendChild(n);
    return item;
  }
  function changeYears(){
    document.getElementById("year").innerHTML='';
    let y=(deg=="UG")?years.ug:years.pg;
    for(let i=0;i<y.length;i++){
      let opt=document.createElement('option');
      opt.value=y[i];
      opt.innerText=y[i];
      document.getElementById("year").add(opt);
    }
  }
  function populateNamelist(students){
    document.getElementById("students-display").innerHTML='';
    document.getElementById("students-display").appendChild(createStudent("S.No","Register Number","Student Name"));
    for(let i=0;i<students.length;i++){
      let student=students[i];
      document.getElementById("students-display").appendChild(createStudent(student["S.no"],student.regNo,student.name));
    }
  }
  $(
    $.ajax({
      type:'POST',
      url:'./PHP/getStudents.php',
      data:{
        Degree:deg,
        Year:year
      },
      complete:(r)=>{
        try{
          let d=JSON.parse(r.responseText);
          populateNamelist(d["data"]);
          changeYears();
        }catch(e){
          console.log("Name List Not Found");
        }
      }
    })
  );
  $("input[name='degree']").change(()=>{
    year=currentYr;
    if($('#ug').is(":checked"))
      deg='UG';
    else deg="PG";
    changeYears();
    $.ajax({
      type:'POST',
      url:'./getStudents.php',
      data:{
        Degree:deg,
        Year:year
      },
      complete:(r)=>{
        try{
          let d=JSON.parse(r.responseText);
          populateNamelist(d["data"]);
        }catch(e){
          console.log("Name List Not Found");
        }
      }
    });
  });
  $("select[name='year']").change(()=>{
    year=document.getElementsByName('year')[0].value;
    $.ajax({
      type:'POST',
      url:'./getStudents.php',
      data:{
        Degree:deg,
        Year:year
      },
      complete:(r)=>{
        try{
          let d=JSON.parse(r.responseText);
          populateNamelist(d["data"]);
        }catch(e){
          console.log("Name List Not Found");
        }
      }
    });
  });
  
</script>
</html>